(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}function n(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class i extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new i),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const l=i.getInstance();class o extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,n=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:n,required:!0,minLength:5},i={value:+r,required:!0,min:1,max:5};return t({value:e,required:!0})&&t(s)&&t(i)?[e,n,+r]:void alert("Invalid input, please try again!")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;l.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],o.prototype,"submitHandler",null);class a extends e{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],a.prototype,"dragStartHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");l.moveProject(t,"active"===this.type?r.Active:r.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),l.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new a(this.element.querySelector("ul").id,e)}}c([n],d.prototype,"dragOverHandler",null),c([n],d.prototype,"dropHandler",null),c([n],d.prototype,"dragLeaveHandler",null),new o,new d("active"),new d("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFBYXZFLEtBQUs4RyxrQkFDaEQ5RyxLQUFLUSxRQUFRK0QsaUJBQWlCLE9BQVF2RSxLQUFLMEcsYUFFM0MzQyxFQUFhckIsYUFBYUksSUFDekIsTUFBTWtFLEVBQW1CbEUsRUFBU21FLFFBQVFwRCxHQUN2QixXQUFkN0QsS0FBS29HLEtBQ0R2QyxFQUFJdEIsU0FBV0wsRUFBY29CLE9BRTlCTyxFQUFJdEIsU0FBV0wsRUFBYzJFLFdBRXJDN0csS0FBS3FHLGlCQUFtQlcsRUFDeEJoSCxLQUFLa0gsb0JBSVB6QyxnQkFDQyxNQUFNMEMsRUFBUyxHQUFHbkgsS0FBS29HLHFCQUN2QnBHLEtBQUtRLFFBQVEyRCxjQUFjLE1BQU96RCxHQUFLeUcsRUFDdkNuSCxLQUFLUSxRQUFRMkQsY0FBYyxNQUFPK0IsWUFDakNsRyxLQUFLb0csS0FBS2dCLGNBQWdCLFlBR3BCRixpQkFDUWhILFNBQVNDLGVBQ3ZCLEdBQUdILEtBQUtvRyxzQkFFRmlCLFVBQVksR0FDbkIsSUFBSyxNQUFNQyxLQUFXdEgsS0FBS3FHLGlCQUMxQixJQUFJYixFQUFZeEYsS0FBS1EsUUFBUTJELGNBQWMsTUFBT3pELEdBQUk0RyxJQXJEeEQsR0FEQzVGLEcsb0NBVUQsR0FEQ0EsRyxnQ0FVRCxHQURDQSxHLHFDQ3JDRixJQUFJdUMsRUFDSixJQUFJa0MsRUFBWSxVQUNoQixJQUFJQSxFQUFZLGEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9kZWNvcmF0b3JzL2F1dG9iaW5kLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvc3RhdGUvcHJvamVjdC1zdGF0ZS50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL2FwcC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuTWFya2luZyB0aGlzIGFzIGRlZmF1bHQgbWVhbnMgaXQgaXMgdGhlIGRlZmF1bHQgZXhwb3J0IG9mIHRoaXMgZmlsZS5cblRoZXJlIGNhbiBvbmx5IGJlIG9uZSBkZWZhdWx0IHBlciBmaWxlXG4qL1xuXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcbiAgdGVtcGxhdGVFbGVtZW50OiBIVE1MVGVtcGxhdGVFbGVtZW50O1xuICBob3N0RWxlbWVudDogVDtcbiAgZWxlbWVudDogVTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICB0ZW1wbGF0ZUlkOiBzdHJpbmcsXG4gICAgaG9zdEVsZW1lbnRJZDogc3RyaW5nLFxuICAgIGluc2VydEF0U3RhcnQ6IGJvb2xlYW4sXG4gICAgbmV3RWxlbWVudElkPzogc3RyaW5nXG4gICkge1xuICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgICB0ZW1wbGF0ZUlkXG4gICAgKSEgYXMgSFRNTFRlbXBsYXRlRWxlbWVudDtcbiAgICB0aGlzLmhvc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9zdEVsZW1lbnRJZCkhIGFzIFQ7XG5cbiAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKFxuICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCxcbiAgICAgIHRydWVcbiAgICApO1xuICAgIHRoaXMuZWxlbWVudCA9IGltcG9ydGVkTm9kZS5maXJzdEVsZW1lbnRDaGlsZCBhcyBVO1xuICAgIGlmIChuZXdFbGVtZW50SWQpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5pZCA9IG5ld0VsZW1lbnRJZDtcbiAgICB9XG5cbiAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KTtcbiAgfVxuXG4gIHByaXZhdGUgYXR0YWNoKGluc2VydEF0QmVnaW5uaW5nOiBib29sZWFuKSB7XG4gICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXG4gICAgICBpbnNlcnRBdEJlZ2lubmluZyA/ICdhZnRlcmJlZ2luJyA6ICdiZWZvcmVlbmQnLFxuICAgICAgdGhpcy5lbGVtZW50XG4gICAgKTtcbiAgfVxuXG4gIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xuICBhYnN0cmFjdCByZW5kZXJDb250ZW50KCk6IHZvaWQ7XG59XG4iLCIvLyBWYWxpZGF0aW9uXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRhYmxlIHtcbiAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcbiAgcmVxdWlyZWQ/OiBib29sZWFuO1xuICBtaW5MZW5ndGg/OiBudW1iZXI7XG4gIG1heExlbmd0aD86IG51bWJlcjtcbiAgbWluPzogbnVtYmVyO1xuICBtYXg/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZSh2YWxpZGF0YWJsZUlucHV0OiBWYWxpZGF0YWJsZSkge1xuICBsZXQgaXNWYWxpZCA9IHRydWU7XG4gIGlmICh2YWxpZGF0YWJsZUlucHV0LnJlcXVpcmVkKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggIT09IDA7XG4gIH1cbiAgaWYgKFxuICAgIHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiZcbiAgICB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZydcbiAgKSB7XG4gICAgaXNWYWxpZCA9XG4gICAgICBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoID49IHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoO1xuICB9XG4gIGlmIChcbiAgICB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aCAhPSBudWxsICYmXG4gICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdzdHJpbmcnXG4gICkge1xuICAgIGlzVmFsaWQgPVxuICAgICAgaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA8PSB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aDtcbiAgfVxuICBpZiAoXG4gICAgdmFsaWRhdGFibGVJbnB1dC5taW4gIT0gbnVsbCAmJlxuICAgIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnbnVtYmVyJ1xuICApIHtcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID49IHZhbGlkYXRhYmxlSW5wdXQubWluO1xuICB9XG4gIGlmIChcbiAgICB2YWxpZGF0YWJsZUlucHV0Lm1heCAhPSBudWxsICYmXG4gICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInXG4gICkge1xuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPD0gdmFsaWRhdGFibGVJbnB1dC5tYXg7XG4gIH1cbiAgcmV0dXJuIGlzVmFsaWQ7XG59XG4iLCIvLyBhdXRvYmluZCBkZWNvcmF0b3JcbmV4cG9ydCBmdW5jdGlvbiBhdXRvYmluZChfOiBhbnksIF8yOiBzdHJpbmcsIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcikge1xuICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gIGNvbnN0IGFkakRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgZ2V0KCkge1xuICAgICAgY29uc3QgYm91bmRGbiA9IG9yaWdpbmFsTWV0aG9kLmJpbmQodGhpcyk7XG4gICAgICByZXR1cm4gYm91bmRGbjtcbiAgICB9XG4gIH07XG4gIHJldHVybiBhZGpEZXNjcmlwdG9yO1xufVxuIiwiZXhwb3J0IGVudW0gUHJvamVjdFN0YXR1cyB7XG4gIEFjdGl2ZSxcbiAgRmluaXNoZWRcbn1cblxuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgaWQ6IHN0cmluZyxcbiAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcbiAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcbiAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXG4gICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1c1xuICApIHt9XG59XG4iLCJpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XG5cbi8vIFByb2plY3QgU3RhdGUgTWFuYWdlbWVudFxudHlwZSBMaXN0ZW5lcjxUPiA9IChpdGVtczogVFtdKSA9PiB2b2lkO1xuXG5jbGFzcyBTdGF0ZTxUPiB7XG5cdHByb3RlY3RlZCBsaXN0ZW5lcnM6IExpc3RlbmVyPFQ+W10gPSBbXTtcblxuXHRhZGRMaXN0ZW5lcihsaXN0ZW5lckZuOiBMaXN0ZW5lcjxUPikge1xuXHRcdHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVuZXJGbik7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFByb2plY3RTdGF0ZSBleHRlbmRzIFN0YXRlPFByb2plY3Q+IHtcblx0cHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW107XG5cdHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBQcm9qZWN0U3RhdGU7XG5cblx0cHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcblx0XHRzdXBlcigpO1xuXHR9XG5cblx0c3RhdGljIGdldEluc3RhbmNlKCkge1xuXHRcdGlmICh0aGlzLmluc3RhbmNlKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5pbnN0YW5jZTtcblx0XHR9XG5cdFx0dGhpcy5pbnN0YW5jZSA9IG5ldyBQcm9qZWN0U3RhdGUoKTtcblx0XHRyZXR1cm4gdGhpcy5pbnN0YW5jZTtcblx0fVxuXG5cdGFkZFByb2plY3QodGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgbnVtT2ZQZW9wbGU6IG51bWJlcikge1xuXHRcdGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChcblx0XHRcdE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSxcblx0XHRcdHRpdGxlLFxuXHRcdFx0ZGVzY3JpcHRpb24sXG5cdFx0XHRudW1PZlBlb3BsZSxcblx0XHRcdFByb2plY3RTdGF0dXMuQWN0aXZlXG5cdFx0KTtcblx0XHR0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdCk7XG5cdFx0dGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcblx0fVxuXG5cdG1vdmVQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nLCBuZXdTdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcblx0XHRjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKChwcmopID0+IHByai5pZCA9PT0gcHJvamVjdElkKTtcblx0XHRpZiAocHJvamVjdCAmJiBwcm9qZWN0LnN0YXR1cyAhPT0gbmV3U3RhdHVzKSB7XG5cdFx0XHRwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcblx0XHRcdHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVMaXN0ZW5lcnMoKSB7XG5cdFx0Zm9yIChjb25zdCBsaXN0ZW5lckZuIG9mIHRoaXMubGlzdGVuZXJzKSB7XG5cdFx0XHRsaXN0ZW5lckZuKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBQcm9qZWN0U3RhdGUuZ2V0SW5zdGFuY2UoKTtcbiIsImltcG9ydCBDbXAgZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjsgLy9TaW5jZSB0aGUgQ2xhc3MgQ29tcG9udGVudCBpcyBtYXJrZWQgYXMgZGVmYXVsdCBpbiBiYXNlLWNvbXBvbnRlbnQudHMgeW91IGNhbiBpbXBvcnQgaXQgd2l0aG91dCBjdXJseS1icmFjZXMgdW5kZXIgYW55IG5hbWVcbmltcG9ydCAqIGFzIFZhbGlkYXRpb24gZnJvbSBcIi4uL3V0aWwvdmFsaWRhdGlvblwiOyAvL1RoaXMgaXMgY2FsbGVkIFwiZ3JvdXBpbmdcIi4gWW91IGNhbiBpbXBvcnQgZXZlcnl0aGluZygqKSBmcm9tIGEgTW9kdWxlIGFuZCBzYXZlIGl0IGFzIGFuIG9iamVjdFxuaW1wb3J0IHsgYXV0b2JpbmQgYXMgQXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiOyAvL1lvdSBjYW4gYWxzbyB1c2UgYW4gQWxpYXMgd2hlbiBpbXBvcnRpbmcgc29tZXRoaW5nXG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiO1xuXG4vLyBXaXRoIG1vZHVsZXMgeW91IGRvIG5vdCBuZWVkIHRoZSBuYW1lc3BhY2UtdGFnXG5leHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQ21wPEhUTUxEaXZFbGVtZW50LCBIVE1MRm9ybUVsZW1lbnQ+IHtcblx0dGl0bGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cdGRlc2NyaXB0aW9uSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xuXHRwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0c3VwZXIoXCJwcm9qZWN0LWlucHV0XCIsIFwiYXBwXCIsIHRydWUsIFwidXNlci1pbnB1dFwiKTtcblx0XHR0aGlzLnRpdGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcIiN0aXRsZVwiXG5cdFx0KSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXHRcdHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFwiI2Rlc2NyaXB0aW9uXCJcblx0XHQpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cdFx0dGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFwiI3Blb3BsZVwiXG5cdFx0KSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXHRcdHRoaXMuY29uZmlndXJlKCk7XG5cdH1cblxuXHRjb25maWd1cmUoKSB7XG5cdFx0dGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5zdWJtaXRIYW5kbGVyKTtcblx0fVxuXG5cdHJlbmRlckNvbnRlbnQoKSB7fVxuXG5cdHByaXZhdGUgZ2F0aGVyVXNlcklucHV0KCk6IFtzdHJpbmcsIHN0cmluZywgbnVtYmVyXSB8IHZvaWQge1xuXHRcdGNvbnN0IGVudGVyZWRUaXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XG5cdFx0Y29uc3QgZW50ZXJlZERlc2NyaXB0aW9uID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZTtcblx0XHRjb25zdCBlbnRlcmVkUGVvcGxlID0gdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWU7XG5cblx0XHRjb25zdCB0aXRsZVZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuXHRcdFx0Ly9Ob3cgeW91IG5lZWQgdG8gY2FsbCBWYWxpZGF0YWJsZSBsaWtlIGEgbWV0aG9kIGZyb20gYW4gb2JqZWN0XG5cdFx0XHR2YWx1ZTogZW50ZXJlZFRpdGxlLFxuXHRcdFx0cmVxdWlyZWQ6IHRydWUsXG5cdFx0fTtcblx0XHRjb25zdCBkZXNjcmlwdGlvblZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuXHRcdFx0dmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcblx0XHRcdHJlcXVpcmVkOiB0cnVlLFxuXHRcdFx0bWluTGVuZ3RoOiA1LFxuXHRcdH07XG5cdFx0Y29uc3QgcGVvcGxlVmFsaWRhdGFibGU6IFZhbGlkYXRpb24uVmFsaWRhdGFibGUgPSB7XG5cdFx0XHR2YWx1ZTogK2VudGVyZWRQZW9wbGUsXG5cdFx0XHRyZXF1aXJlZDogdHJ1ZSxcblx0XHRcdG1pbjogMSxcblx0XHRcdG1heDogNSxcblx0XHR9O1xuXG5cdFx0aWYgKFxuXHRcdFx0IVZhbGlkYXRpb24udmFsaWRhdGUodGl0bGVWYWxpZGF0YWJsZSkgfHxcblx0XHRcdCFWYWxpZGF0aW9uLnZhbGlkYXRlKGRlc2NyaXB0aW9uVmFsaWRhdGFibGUpIHx8XG5cdFx0XHQhVmFsaWRhdGlvbi52YWxpZGF0ZShwZW9wbGVWYWxpZGF0YWJsZSlcblx0XHQpIHtcblx0XHRcdGFsZXJ0KFwiSW52YWxpZCBpbnB1dCwgcGxlYXNlIHRyeSBhZ2FpbiFcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBbZW50ZXJlZFRpdGxlLCBlbnRlcmVkRGVzY3JpcHRpb24sICtlbnRlcmVkUGVvcGxlXTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGNsZWFySW5wdXRzKCkge1xuXHRcdHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUgPSBcIlwiO1xuXHRcdHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWUgPSBcIlwiO1xuXHRcdHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlID0gXCJcIjtcblx0fVxuXG5cdEBBdXRvYmluZFxuXHRwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KSB7XG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dCgpO1xuXHRcdGlmIChBcnJheS5pc0FycmF5KHVzZXJJbnB1dCkpIHtcblx0XHRcdGNvbnN0IFt0aXRsZSwgZGVzYywgcGVvcGxlXSA9IHVzZXJJbnB1dDtcblx0XHRcdHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjLCBwZW9wbGUpO1xuXHRcdFx0dGhpcy5jbGVhcklucHV0cygpO1xuXHRcdH1cblx0fVxufVxuIiwiaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIjtcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcbmltcG9ydCBDb21wb25lbnQgZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcbmltcG9ydCB7IGF1dG9iaW5kIH0gZnJvbSBcIi4uL2RlY29yYXRvcnMvYXV0b2JpbmRcIjtcblxuLy8gUHJvamVjdEl0ZW0gQ2xhc3NcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SXRlbVxuXHRleHRlbmRzIENvbXBvbmVudDxIVE1MVUxpc3RFbGVtZW50LCBIVE1MTElFbGVtZW50PlxuXHRpbXBsZW1lbnRzIERyYWdnYWJsZVxue1xuXHRwcml2YXRlIHByb2plY3Q6IFByb2plY3Q7XG5cblx0Z2V0IHBlcnNvbnMoKSB7XG5cdFx0aWYgKHRoaXMucHJvamVjdC5wZW9wbGUgPT09IDEpIHtcblx0XHRcdHJldHVybiBcIjEgcGVyc29uXCI7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYDtcblx0XHR9XG5cdH1cblxuXHRjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xuXHRcdHN1cGVyKFwic2luZ2xlLXByb2plY3RcIiwgaG9zdElkLCBmYWxzZSwgcHJvamVjdC5pZCk7XG5cdFx0dGhpcy5wcm9qZWN0ID0gcHJvamVjdDtcblxuXHRcdHRoaXMuY29uZmlndXJlKCk7XG5cdFx0dGhpcy5yZW5kZXJDb250ZW50KCk7XG5cdH1cblxuXHRAYXV0b2JpbmRcblx0ZHJhZ1N0YXJ0SGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XG5cdFx0ZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKFwidGV4dC9wbGFpblwiLCB0aGlzLnByb2plY3QuaWQpO1xuXHRcdGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9IFwibW92ZVwiO1xuXHR9XG5cblx0ZHJhZ0VuZEhhbmRsZXIoXzogRHJhZ0V2ZW50KSB7XG5cdFx0Y29uc29sZS5sb2coXCJEcmFnRW5kXCIpO1xuXHR9XG5cblx0Y29uZmlndXJlKCkge1xuXHRcdHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlcik7XG5cdFx0dGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnZW5kXCIsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpO1xuXHR9XG5cblx0cmVuZGVyQ29udGVudCgpIHtcblx0XHR0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcImgyXCIpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC50aXRsZTtcblx0XHR0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcImgzXCIpIS50ZXh0Q29udGVudCA9IHRoaXMucGVyc29ucyArIFwiIGFzc2lnbmVkXCI7XG5cdFx0dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJwXCIpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kZXNjcmlwdGlvbjtcblx0fVxufVxuIiwiaW1wb3J0IHsgRHJhZ1RhcmdldCB9IGZyb20gXCIuLi9tb2RlbHMvZHJhZy1kcm9wXCI7XG5pbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XG5pbXBvcnQgQ29tcG9uZW50IGZyb20gXCIuL2Jhc2UtY29tcG9uZW50XCI7XG5pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiO1xuaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tIFwiLi9wcm9qZWN0LWl0ZW1cIjtcblxuLy8gUHJvamVjdExpc3QgQ2xhc3NcbmV4cG9ydCBjbGFzcyBQcm9qZWN0TGlzdFxuXHRleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEVsZW1lbnQ+XG5cdGltcGxlbWVudHMgRHJhZ1RhcmdldFxue1xuXHRhc3NpZ25lZFByb2plY3RzOiBQcm9qZWN0W107XG5cblx0Y29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiBcImFjdGl2ZVwiIHwgXCJmaW5pc2hlZFwiKSB7XG5cdFx0c3VwZXIoXCJwcm9qZWN0LWxpc3RcIiwgXCJhcHBcIiwgZmFsc2UsIGAke3R5cGV9LXByb2plY3RzYCk7XG5cdFx0dGhpcy5hc3NpZ25lZFByb2plY3RzID0gW107XG5cblx0XHR0aGlzLmNvbmZpZ3VyZSgpO1xuXHRcdHRoaXMucmVuZGVyQ29udGVudCgpO1xuXHR9XG5cblx0QGF1dG9iaW5kXG5cdGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XG5cdFx0aWYgKGV2ZW50LmRhdGFUcmFuc2ZlciAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09IFwidGV4dC9wbGFpblwiKSB7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0Y29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKSE7XG5cdFx0XHRsaXN0RWwuY2xhc3NMaXN0LmFkZChcImRyb3BwYWJsZVwiKTtcblx0XHR9XG5cdH1cblxuXHRAYXV0b2JpbmRcblx0ZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuXHRcdGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKFwidGV4dC9wbGFpblwiKTtcblx0XHRwcm9qZWN0U3RhdGUubW92ZVByb2plY3QoXG5cdFx0XHRwcmpJZCxcblx0XHRcdHRoaXMudHlwZSA9PT0gXCJhY3RpdmVcIiA/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZFxuXHRcdCk7XG5cdH1cblxuXHRAYXV0b2JpbmRcblx0ZHJhZ0xlYXZlSGFuZGxlcihfOiBEcmFnRXZlbnQpIHtcblx0XHRjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcInVsXCIpITtcblx0XHRsaXN0RWwuY2xhc3NMaXN0LnJlbW92ZShcImRyb3BwYWJsZVwiKTtcblx0fVxuXG5cdGNvbmZpZ3VyZSgpIHtcblx0XHR0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKTtcblx0XHR0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpO1xuXHRcdHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCB0aGlzLmRyb3BIYW5kbGVyKTtcblxuXHRcdHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xuXHRcdFx0Y29uc3QgcmVsZXZhbnRQcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcigocHJqKSA9PiB7XG5cdFx0XHRcdGlmICh0aGlzLnR5cGUgPT09IFwiYWN0aXZlXCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5BY3RpdmU7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHByai5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuRmluaXNoZWQ7XG5cdFx0XHR9KTtcblx0XHRcdHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IHJlbGV2YW50UHJvamVjdHM7XG5cdFx0XHR0aGlzLnJlbmRlclByb2plY3RzKCk7XG5cdFx0fSk7XG5cdH1cblxuXHRyZW5kZXJDb250ZW50KCkge1xuXHRcdGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGA7XG5cdFx0dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKSEuaWQgPSBsaXN0SWQ7XG5cdFx0dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoMlwiKSEudGV4dENvbnRlbnQgPVxuXHRcdFx0dGhpcy50eXBlLnRvVXBwZXJDYXNlKCkgKyBcIiBQUk9KRUNUU1wiO1xuXHR9XG5cblx0cHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpIHtcblx0XHRjb25zdCBsaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcblx0XHRcdGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGBcblx0XHQpISBhcyBIVE1MVUxpc3RFbGVtZW50O1xuXHRcdGxpc3RFbC5pbm5lckhUTUwgPSBcIlwiO1xuXHRcdGZvciAoY29uc3QgcHJqSXRlbSBvZiB0aGlzLmFzc2lnbmVkUHJvamVjdHMpIHtcblx0XHRcdG5ldyBQcm9qZWN0SXRlbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcInVsXCIpIS5pZCwgcHJqSXRlbSk7XG5cdFx0fVxuXHR9XG59XG4iLCJpbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dCc7XG5pbXBvcnQgeyBQcm9qZWN0TGlzdCB9IGZyb20gJy4vY29tcG9uZW50cy9wcm9qZWN0LWxpc3QnO1xuXG5uZXcgUHJvamVjdElucHV0KCk7XG5uZXcgUHJvamVjdExpc3QoJ2FjdGl2ZScpO1xubmV3IFByb2plY3RMaXN0KCdmaW5pc2hlZCcpO1xuIl0sIm5hbWVzIjpbIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwidGVtcGxhdGVJZCIsImhvc3RFbGVtZW50SWQiLCJpbnNlcnRBdFN0YXJ0IiwibmV3RWxlbWVudElkIiwidGhpcyIsInRlbXBsYXRlRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJob3N0RWxlbWVudCIsImltcG9ydGVkTm9kZSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiZWxlbWVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiaWQiLCJhdHRhY2giLCJpbnNlcnRBdEJlZ2lubmluZyIsImluc2VydEFkamFjZW50RWxlbWVudCIsInZhbGlkYXRlIiwidmFsaWRhdGFibGVJbnB1dCIsImlzVmFsaWQiLCJyZXF1aXJlZCIsInZhbHVlIiwidG9TdHJpbmciLCJ0cmltIiwibGVuZ3RoIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibWluIiwibWF4IiwiYXV0b2JpbmQiLCJfIiwiXzIiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJjb25maWd1cmFibGUiLCJnZXQiLCJiaW5kIiwiUHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwiUHJvamVjdFN0YXRlIiwibGlzdGVuZXJzIiwiYWRkTGlzdGVuZXIiLCJsaXN0ZW5lckZuIiwicHVzaCIsInN1cGVyIiwicHJvamVjdHMiLCJzdGF0aWMiLCJpbnN0YW5jZSIsImFkZFByb2plY3QiLCJudW1PZlBlb3BsZSIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwiQWN0aXZlIiwidXBkYXRlTGlzdGVuZXJzIiwibW92ZVByb2plY3QiLCJwcm9qZWN0SWQiLCJuZXdTdGF0dXMiLCJwcm9qZWN0IiwiZmluZCIsInByaiIsInNsaWNlIiwicHJvamVjdFN0YXRlIiwiZ2V0SW5zdGFuY2UiLCJQcm9qZWN0SW5wdXQiLCJ0aXRsZUlucHV0RWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJkZXNjcmlwdGlvbklucHV0RWxlbWVudCIsInBlb3BsZUlucHV0RWxlbWVudCIsImNvbmZpZ3VyZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdWJtaXRIYW5kbGVyIiwicmVuZGVyQ29udGVudCIsImdhdGhlclVzZXJJbnB1dCIsImVudGVyZWRUaXRsZSIsImVudGVyZWREZXNjcmlwdGlvbiIsImVudGVyZWRQZW9wbGUiLCJkZXNjcmlwdGlvblZhbGlkYXRhYmxlIiwicGVvcGxlVmFsaWRhdGFibGUiLCJhbGVydCIsImNsZWFySW5wdXRzIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJJbnB1dCIsIkFycmF5IiwiaXNBcnJheSIsImRlc2MiLCJQcm9qZWN0SXRlbSIsImhvc3RJZCIsInBlcnNvbnMiLCJkcmFnU3RhcnRIYW5kbGVyIiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImVmZmVjdEFsbG93ZWQiLCJkcmFnRW5kSGFuZGxlciIsImNvbnNvbGUiLCJsb2ciLCJ0ZXh0Q29udGVudCIsIlByb2plY3RMaXN0IiwidHlwZSIsImFzc2lnbmVkUHJvamVjdHMiLCJkcmFnT3ZlckhhbmRsZXIiLCJ0eXBlcyIsImNsYXNzTGlzdCIsImFkZCIsImRyb3BIYW5kbGVyIiwicHJqSWQiLCJnZXREYXRhIiwiRmluaXNoZWQiLCJkcmFnTGVhdmVIYW5kbGVyIiwicmVtb3ZlIiwicmVsZXZhbnRQcm9qZWN0cyIsImZpbHRlciIsInJlbmRlclByb2plY3RzIiwibGlzdElkIiwidG9VcHBlckNhc2UiLCJpbm5lckhUTUwiLCJwcmpJdGVtIl0sInNvdXJjZVJvb3QiOiIifQ==